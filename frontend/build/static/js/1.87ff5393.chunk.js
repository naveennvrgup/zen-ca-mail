(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{505:function(e,t,a){"use strict";a.r(t);var n=a(18),s=a.n(n),r=a(27),l=a(7),o=a(1),i=a(5),c=a(3),m=a(2),p=a(4),d=a(0),u=a.n(d),f=a(10),g=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).axios=Object(f.b)(),a.state={progress:0,onprogress:!1},a.componentDidMount=function(){a.setState(Object(l.a)({},a.state,a.props))},a.selectFilesHandler=function(e){e.preventDefault();var t=document.createElement("input");t.type="file",t.accept="image/x-png,image/gif,image/jpeg",t.click(),t.addEventListener("change",function(e){var t=e.target.files[0];a.uploadFileHandler(t)})},a.uploadFileHandler=function(e){var t=new FormData,n=new XMLHttpRequest;console.log(a.props),t.append("group_id",a.props.selected_group_id),t.append("img",e),n.addEventListener("load",function(e){var t=e.target.response;console.log(t),a.setState(Object(l.a)({},a.state,t,{onprogress:!1}))}),n.upload.addEventListener("progress",function(e){var t=e.loaded/e.total*100+"%";console.log(t),a.setState(Object(l.a)({},a.state,{progress:t}))}),n.upload.addEventListener("abort",function(e){a.setState(Object(l.a)({},a.state,{onprogress:!1,progress:0}))}),n.responseType="json",n.open("patch",f.a+"api/news/".concat(a.props.newsId,"/")),n.setRequestHeader("Authorization",sessionStorage.token),n.send(t),a.setState(Object(l.a)({},a.state,{progress:0,onprogress:!0,request:n}))},a.abortUploadHandler=function(e){e.preventDefault(),a.state.request.abort()},a.delete_handler=function(e){e.preventDefault(),a.axios.patch("api/news/".concat(a.state.id,"/"),{img:null}).then(function(e){console.log(e.data),a.setState(Object(l.a)({},a.state,e.data,{progress:0})),console.log(a.state)})},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.onprogress?u.a.createElement("i",{className:"fa fa-times"}):u.a.createElement("i",{className:"fa fa-upload"}),t=u.a.createElement("button",{onClick:this.delete_handler,className:"btn btn-primary"},u.a.createElement("i",{className:"fa fa-times"})),a=u.a.createElement("button",{onClick:this.state.onprogress?this.abortUploadHandler:this.selectFilesHandler,className:"btn btn-primary"},e),n=this.state.img?t:a,s=u.a.createElement("div",{className:"progress mx-2 ".concat(this.state.onprogress?"":"hide-progress")},u.a.createElement("div",{className:"progress-bar progress-bar-striped",style:{width:this.state.progress}})),r=this.state.img&&this.state.img.split("/").pop();return u.a.createElement("div",{className:"flex-grow-1 px-0"},u.a.createElement("div",{className:"new_sub_csv d-flex justify-content-between align-items-center"},u.a.createElement("div",{className:""},u.a.createElement("span",null,r||"No images attached to the news"),this.state.img&&u.a.createElement("span",{className:"badge text-white mx-2 badge-dark badge-pill"},u.a.createElement("a",{href:this.state.img,rel:"noopener noreferrer",target:"_blank"},"link"))),u.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},s,n)))}}]),t}(d.Component);a.d(t,"default",function(){return b});var b=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),p=0;p<n;p++)i[p]=arguments[p];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).axios=Object(f.b)(),a.state={},a.componentDidMount=function(){a.files=document.querySelector(".edit_news"),a.title=a.files.querySelector(".title"),a.link=a.files.querySelector(".link"),a.brief=a.files.querySelector(".brief"),a.newsId=a.props.match.params.id,a.axios.get("api/news/"+a.newsId+"/").then(function(e){e=e.data,console.log(e),a.title.value=e.title,a.link.value=e.link,a.brief.value=e.brief,a.setState(Object(l.a)({},a.state,e))})},a.saveNewsHandler=function(e,t){e.preventDefault(),a.axios.put("api/news/"+a.state.id+"/",{title:a.title.value,link:a.link.value,brief:a.brief.value,show:t||a.state.show}).then(function(e){console.log(e.data),a.props.history.push("/admin/news/")})},a.showNewsHandler=function(){var e=Object(r.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,a.saveNewsHandler(t,!0);case 3:a.props.history.push("/admin/news/");case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.deleteNewsHandler=function(e){e.preventDefault(),a.axios.patch("api/news/"+a.newsId+"/",{flag:!0}).then(function(e){console.log(e.data),a.props.history.push("/admin/news/")})},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=u.a.createElement("h1",null,"Edit News");return u.a.createElement("div",{className:"edit_news p-5"},u.a.createElement("form",{className:"ml-3"},u.a.createElement("div",{className:"d-flex align-items-center justify-content-between"},e,u.a.createElement("div",{className:"buttons py-3 d-flex"},u.a.createElement("button",{className:"btn btn-outline-danger mr-3",onClick:this.deleteNewsHandler},"delete"),u.a.createElement("button",{className:"btn mr-3",onClick:this.saveNewsHandler},"save"),u.a.createElement("button",{className:"btn btn-success",onClick:this.showNewsHandler},"show"))),u.a.createElement("div",{className:"form-group mt-3"},u.a.createElement("label",{className:"font-weight-bold"},"Title:"),u.a.createElement("input",{type:"text",className:"title form-control w-100"})),u.a.createElement("div",{className:"form-group mt-3"},u.a.createElement("label",{className:"font-weight-bold"},"Img:"),u.a.createElement("div",{className:"form-control d-flex pr-0 align-items-center"},this.state.id&&u.a.createElement(g,Object.assign({},this.state,{newsId:this.state.id})))),u.a.createElement("div",{className:"form-group mt-3"},u.a.createElement("label",{className:"font-weight-bold"},"Link:"),u.a.createElement("input",{type:"text",className:"link form-control w-100"})),u.a.createElement("div",{className:"form-group mt-3"},u.a.createElement("label",{className:"font-weight-bold"},"Brief:"),u.a.createElement("textarea",{rows:"4",className:"brief form-control w-100"}))))}}]),t}(d.Component)}}]);
//# sourceMappingURL=1.87ff5393.chunk.js.map