{"version":3,"sources":["admin/email/send_mail.js"],"names":["send_mail","axios","faxios","state","groups","draft","subject","body","files","componentDidMount","_this","draftId","props","match","params","id","document","querySelector","group","get","then","d","data","console","log","setState","Object","_home_nvrgup_Desktop_zen_ca_mail_frontend_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","concat","innerHTML","send_mail_handler","e","preventDefault","value","post","history","push","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","className","key","this","forEach","ele","name","subs","attachments","map","href","file","split","pop","onClick","goBack","disabled","defaultValue","Component"],"mappings":"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","file":"static/js/6.ddb55e62.chunk.js","sourcesContent":["import React, { Component } from 'react'\nimport faxios from '../../axios'\n\nexport default class send_mail extends Component {\n    axios = faxios()\n    state = {\n        groups: [],\n        draft: {\n            subject: '',\n            body: '',\n            files: []\n        }\n    }\n\n    componentDidMount = () => {\n        this.draftId = this.props.match.params.id\n        this.send_mail = document.querySelector('.send-mail');\n        this.body = this.send_mail.querySelector('.body');\n        this.group = this.send_mail.querySelector('#group');\n\n\n        this.axios.get('api/group/')\n            .then(d => {\n                d = d.data\n                console.log(d)\n                this.setState({\n                    ...this.state,\n                    groups: d\n                })\n            })\n\n        this.axios.get(`api/draft/${this.draftId}/`)\n            .then(d => {\n                d = d.data\n                console.log(d)\n                this.body.innerHTML = d.body\n                this.setState({\n                    ...this.state,\n                    draft: d\n                })\n            })\n    }\n\n    send_mail_handler = e => {\n        e.preventDefault()\n\n        if(this.group.value==='0'){\n            return\n        }\n        \n        this.axios.post('api/send_bulk_mail/', {\n            group: this.group.value,\n            draft: this.draftId\n        }).then(d => {\n            console.log(d.data)\n            this.props.history.push('/admin/email/')\n        })\n    }\n\n\n    render() {\n        const groups = [<option\n            className='form-control'\n            key={0}\n            value={0}>--choose--</option>]\n\n        this.state.groups.forEach(ele =>\n            groups.push(<option\n                className='form-control'\n                key={ele.id}\n                value={ele.id}>{ele.name} ({ele.subs})</option>)\n        )\n\n        const attachments = this.state.draft.files.map(ele => <li key={ele.id}>\n            <a href={ele.file}>{ele.file.split('/').pop()}</a>\n        </li>)\n\n        return (\n            <div className='send-mail'>\n                <div className=\"d-md-flex justify-content-between align-items-center\">\n                    <h1 className=\"text-center\">Send Mail</h1>\n                    <div className='text-center'>\n                        <button\n                            onClick={this.props.history.goBack}\n                            className=\"btn mx-2\">\n                            <i className=\"fa fa-arrow-left\"></i > back\n                        </button>\n                        <button\n                            disabled={this.state.draft.id ? false : true}\n                            onClick={this.send_mail_handler}\n                            className=\"btn btn-success mx-2 \">\n                            Send <i className=\"fa fa-plane\"></i >\n                        </button>\n                    </div>\n                </div>\n                <div className=\"info mt-4\">\n                    <div className=\"form-group\">\n                        <label className='font-weight-bold'>Subscriber group:</label>\n                        <select\n                            name=\"group\"\n                            className='form-control d-inline-block w-auto mx-3'\n                            defaultValue={0}\n                            id=\"group\">\n                            {groups}\n                        </select>\n                    </div>\n                    <div className=\"form-group\">\n                        <label className='font-weight-bold'>Subject:</label>\n                        <span className=\"subject mx-3\">{this.state.draft.subject}</span>\n                    </div>\n                    <div className=\"form-group\">\n                        <label className='font-weight-bold'>Body:</label>\n                        <div className=\"body\"></div>\n                    </div>\n                    <div className=\"form-group\">\n                        <label className='font-weight-bold'>Attachments:</label>\n                        <ol className=\"attachments\">{attachments}</ol>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n"],"sourceRoot":""}